<!DOCTYPE html>
<html lang="zh-HK">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ä¸­ä¸€æ•¸å­¸è©å½™ (Maths Terms)</title>
<style>
    /* --- é é¢åŸºç¤æ¨£å¼ --- */
    body {
        font-family: "Microsoft JhengHei", "Heiti TC", sans-serif;
        background-color: #f0f8ff;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        margin: 0;
        position: relative;
        padding-bottom: 50px; 
        box-sizing: border-box;
    }

    /* --- å›ä¸»é æŒ‰éˆ•æ¨£å¼ --- */
    .home-btn {
        position: absolute;
        top: 15px;
        left: 15px;
        background-color: white;
        color: #2c3e50;
        border: 2px solid #bdc3c7;
        padding: 8px 15px;
        border-radius: 20px;
        text-decoration: none;
        font-size: 14px;
        font-weight: bold;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        transition: all 0.2s;
        z-index: 1000;
        display: flex;
        align-items: center;
        gap: 5px;
    }
    .home-btn:hover {
        background-color: #ecf0f1;
        transform: translateY(-2px);
    }

    /* --- éŠæˆ²ä¸»å®¹å™¨æ¨£å¼ --- */
    .container {
        background-color: white;
        padding: 30px;
        border-radius: 15px;
        box-shadow: 0 0 20px rgba(0,0,0,0.1);
        width: 90%;
        max-width: 600px;
        text-align: center;
        margin-top: 50px;
        margin-bottom: 20px;
    }

    /* --- Footer æ¨£å¼ --- */
    .footer {
        position: absolute;
        bottom: 15px;
        left: 0;
        width: 100%;
        text-align: center;
        font-size: 13px;
        color: #95a5a6;
    }

    /* --- é€šç”¨å…ƒä»¶æ¨£å¼ --- */
    h1 { color: #2c3e50; font-size: 28px; }
    .btn {
        background-color: #8e44ad; /* æ•¸å­¸ç§‘ç”¨ç´«è‰² */
        color: white;
        border: none;
        padding: 12px 24px;
        font-size: 16px;
        border-radius: 8px;
        cursor: pointer;
        margin: 10px;
        transition: background-color 0.3s;
    }
    .btn:hover { background-color: #732d91; }
    
    /* --- é¸é …æŒ‰éˆ•æ¨£å¼ --- */
    .option-btn {
        display: block;
        width: 100%;
        margin: 10px 0;
        padding: 15px;
        background-color: #ecf0f1;
        color: #2c3e50;
        border: 2px solid #bdc3c7;
        border-radius: 8px;
        font-size: 18px;
        cursor: pointer;
        text-align: left;
        transition: all 0.2s;
    }
    .option-btn:hover { background-color: #d5dbdb; }
    .option-btn.correct { background-color: #2ecc71; border-color: #27ae60; color: white; }
    .option-btn.wrong { background-color: #e74c3c; border-color: #c0392b; color: white; }
    
    /* --- åŠŸèƒ½æ€§æ¨£å¼ --- */
    .hidden { display: none; }
    
    /* --- è¨­å®šé é¢æ¨£å¼ --- */
    .settings-group { margin-bottom: 20px; text-align: left; }
    .settings-group h3 { margin-bottom: 10px; border-bottom: 2px solid #eee; padding-bottom: 5px;}
    
    .checkbox-container {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
    }

    .checkbox-label, .radio-label {
        display: flex;
        align-items: center;
        margin-right: 15px;
        margin-bottom: 5px;
        font-size: 15px;
        cursor: pointer;
    }
    
    .checkbox-label input { margin-right: 8px; }

    /* --- éŠæˆ²é€²è¡Œä¸­æ¨£å¼ --- */
    #question-text { font-size: 28px; font-weight: bold; color: #2c3e50; margin: 20px 0; min-height: 60px;}
    #score-display { font-size: 24px; margin-bottom: 20px; font-weight: bold; color: #e67e22; }
    #progress { font-size: 14px; color: #7f8c8d; margin-bottom: 10px; }
    #final-message { font-size: 20px; margin-bottom: 20px; line-height: 1.6;}

    /* --- éŒ¯é¡Œåˆ—è¡¨æ¨£å¼ (æ–°å¢) --- */
    .mistake-container {
        margin-top: 20px;
        text-align: left;
        background-color: #fff0f0;
        border: 1px solid #ffcccc;
        border-radius: 10px;
        padding: 15px;
        max-height: 300px; /* è¶…éé«˜åº¦å¯æ²å‹• */
        overflow-y: auto;
    }
    .mistake-title {
        color: #c0392b;
        font-weight: bold;
        margin-bottom: 10px;
        border-bottom: 1px solid #ffcccc;
        padding-bottom: 5px;
    }
    .mistake-item {
        margin-bottom: 12px;
        padding-bottom: 12px;
        border-bottom: 1px dashed #eee;
    }
    .mistake-item:last-child { border-bottom: none; }
    .m-word { font-size: 18px; font-weight: bold; color: #2c3e50; }
    .m-wrong { color: #e74c3c; font-size: 14px; margin-top: 2px; }
    .m-correct { color: #27ae60; font-size: 14px; font-weight: bold; margin-top: 2px; }

</style>
</head>
<body>

<a href="index.html" class="home-btn">ğŸ  Home</a>

<div class="container" id="game-container">
    <div id="start-screen">
        <h1>Maths Terms Challenge</h1>
        
        <div class="settings-group">
            <h3>Select Chapters (å¯å¤šé¸)</h3>
            <div class="checkbox-container">
                <label class="checkbox-label"><input type="checkbox" name="section" value="0" checked> Ch 0 - Fundamental</label>
                <label class="checkbox-label"><input type="checkbox" name="section" value="1" checked> Ch 1 - Basic Maths</label>
                <label class="checkbox-label"><input type="checkbox" name="section" value="2" checked> Ch 2 - Numbers</label>
                <label class="checkbox-label"><input type="checkbox" name="section" value="3" checked> Ch 3 - Algebra</label>
                <label class="checkbox-label"><input type="checkbox" name="section" value="4" checked> Ch 4 - Equations</label>
                <label class="checkbox-label"><input type="checkbox" name="section" value="5" checked> Ch 5 - Geometry</label>
            </div>
        </div>

        <div class="settings-group">
            <h3>Questions (é¡Œç›®æ•¸é‡)</h3>
            <label class="radio-label"><input type="radio" name="qCount" value="15"> 15 é¡Œ</label>
            <label class="radio-label"><input type="radio" name="qCount" value="20" checked> 20 é¡Œ</label>
            <label class="radio-label"><input type="radio" name="qCount" value="30"> 30 é¡Œ</label>
            <label class="radio-label"><input type="radio" name="qCount" value="50"> 50 é¡Œ</label>
            <label class="radio-label"><input type="radio" name="qCount" value="80"> 80 é¡Œ</label>
        </div>

        <button class="btn" onclick="startGame()">Start Game</button>
    </div>

    <div id="quiz-screen" class="hidden">
        <div id="progress">é¡Œç›®: 1 / 20</div>
        <div id="question-text">Word</div>
        <div id="options-container">
            </div>
    </div>

    <div id="result-screen" class="hidden">
        <h1>æ¸¬é©—çµæŸ!</h1>
        <div id="score-display">å¾—åˆ†: 0 / 0</div>
        <div id="final-message"></div>
        <div id="mistake-area"></div>
        
        <button class="btn" onclick="location.reload()">Replay é‡ç©</button>
    </div>
</div>

<div class="footer">
    Designed by KLæ€è€ƒç ”ç©¶å®¤
</div>

<script>
    // æ•¸å­¸è©å½™è³‡æ–™åº«
    const vocabData = [
        { s: 0, w: "Natural number", m: "è‡ªç„¶æ•¸" },
        { s: 0, w: "Whole number", m: "æ•´æ•¸" },
        { s: 0, w: "Divisible", m: "å¯æ•´é™¤çš„" },
        { s: 0, w: "Even number", m: "å¶æ•¸" },
        { s: 0, w: "Odd number", m: "å¥‡æ•¸" },
        { s: 0, w: "Quotient", m: "å•†" },
        { s: 0, w: "Addition", m: "åŠ æ³•" },
        { s: 0, w: "Subtraction", m: "æ¸›æ³•" },
        { s: 0, w: "Multiplication", m: "ä¹˜æ³•" },
        { s: 0, w: "Division", m: "é™¤æ³•" },
        { s: 0, w: "Sum", m: "å’Œ" },
        { s: 0, w: "Difference", m: "å·®" },
        { s: 0, w: "Product", m: "ç©" },
        { s: 0, w: "Divisor", m: "é™¤æ•¸" },
        { s: 0, w: "Dividend", m: "è¢«é™¤æ•¸" },
        { s: 0, w: "Remainder", m: "é¤˜æ•¸" },
        { s: 0, w: "Multiple", m: "å€æ•¸" },
        { s: 0, w: "Lowest Common Multiple", m: "æœ€å°å…¬å€æ•¸" },
        { s: 0, w: "Common multiple", m: "å…¬å€æ•¸" },
        { s: 0, w: "Factor", m: "å› æ•¸" },
        { s: 0, w: "Highest Common Factor", m: "æœ€å¤§å…¬å› æ•¸" },
        { s: 0, w: "Greatest common divisor", m: "æœ€å¤§å…¬ç´„æ•¸" },
        { s: 0, w: "Common Factor", m: "å…¬å› æ•¸" },
        { s: 0, w: "Fraction", m: "åˆ†æ•¸" },
        { s: 0, w: "Numerator", m: "åˆ†å­" },
        { s: 0, w: "Denominator", m: "åˆ†æ¯" },
        { s: 0, w: "Proper fraction", m: "çœŸåˆ†æ•¸" },
        { s: 0, w: "Improper fraction", m: "å‡åˆ†æ•¸" },
        { s: 0, w: "Mixed fraction", m: "å¸¶åˆ†æ•¸" },
        { s: 0, w: "Expand a fraction", m: "æ“´åˆ†" },
        { s: 0, w: "Reduce a fraction", m: "ç´„åˆ†" },
        { s: 0, w: "Decimal", m: "å°æ•¸" },
        { s: 0, w: "Reciprocal", m: "å€’æ•¸" },
        { s: 0, w: "Multiplicand", m: "è¢«ä¹˜æ•¸" },
        { s: 0, w: "Multiplier", m: "ä¹˜æ•¸" },
        { s: 1, w: "Power", m: "æ¬¡æ–¹" },
        { s: 1, w: "Index Notation", m: "æŒ‡æ•¸è¨˜æ•¸æ³•" },
        { s: 1, w: "Square", m: "å¹³æ–¹" },
        { s: 1, w: "Cube", m: "ç«‹æ–¹" },
        { s: 1, w: "Base", m: "åº•" },
        { s: 1, w: "Index / Exponent", m: "æŒ‡æ•¸" },
        { s: 1, w: "Expanded Form", m: "é€£ä¹˜å¼" },
        { s: 1, w: "Prime Number", m: "è³ªæ•¸" },
        { s: 1, w: "Composite Number", m: "åˆæˆæ•¸" },
        { s: 1, w: "Prime Factor", m: "è³ªå› æ•¸" },
        { s: 1, w: "Short Division", m: "çŸ­é™¤æ³•" },
        { s: 1, w: "Prime Factorization", m: "è³ªå› æ•¸åˆ†è§£" },
        { s: 2, w: "Directed number", m: "æœ‰å‘æ•¸" },
        { s: 2, w: "Positive number", m: "æ­£æ•¸" },
        { s: 2, w: "Negative number", m: "è² æ•¸" },
        { s: 2, w: "Magnitude", m: "å¤§å°" },
        { s: 2, w: "Opposite number", m: "ç›¸åæ•¸" },
        { s: 2, w: "Integer", m: "æ•´æ•¸" },
        { s: 2, w: "Number line", m: "æ•¸ç·š" },
        { s: 2, w: "Ascending order", m: "éå‡åº" },
        { s: 2, w: "Descending order", m: "éé™åº" },
        { s: 3, w: "Algebra", m: "ä»£æ•¸" },
        { s: 3, w: "Algebraic expressions", m: "ä»£æ•¸å¼" },
        { s: 3, w: "Base", m: "åº•" },
        { s: 3, w: "Index/exponent", m: "æŒ‡æ•¸" },
        { s: 3, w: "Expanded form", m: "é€£ä¹˜å¼" },
        { s: 3, w: "Term", m: "é …" },
        { s: 3, w: "Formula", m: "å…¬å¼" },
        { s: 3, w: "Variable", m: "è®Šæ•¸" },
        { s: 3, w: "Constant", m: "å¸¸æ•¸" },
        { s: 3, w: "Method of substitution", m: "ä»£å…¥æ³•" },
        { s: 3, w: "Sequence of odd numbers", m: "å¥‡æ•¸æ•¸åˆ—" },
        { s: 3, w: "Sequence of even numbers", m: "å¶æ•¸æ•¸åˆ—" },
        { s: 3, w: "Square number", m: "æ­£æ–¹å½¢æ•¸" },
        { s: 3, w: "Sequence of square numbers", m: "æ­£æ–¹å½¢æ•¸æ•¸åˆ—" },
        { s: 3, w: "Triangular number", m: "ä¸‰è§’å½¢æ•¸" },
        { s: 3, w: "Sequence of triangular numbers", m: "ä¸‰è§’å½¢æ•¸æ•¸åˆ—" },
        { s: 3, w: "General term", m: "é€šé …" },
        { s: 3, w: "Function", m: "å‡½æ•¸" },
        { s: 4, w: "Equation", m: "æ–¹ç¨‹" },
        { s: 4, w: "Linear Equation in One Unknown", m: "ä¸€å…ƒä¸€æ¬¡æ–¹ç¨‹" },
        { s: 4, w: "Unknown", m: "æœªçŸ¥æ•¸" },
        { s: 4, w: "Solution", m: "è§£" },
        { s: 4, w: "Root", m: "æ ¹" },
        { s: 4, w: "Transposition of terms", m: "ç§»é …" },
        { s: 4, w: "Distributive law of multiplication", m: "ä¹˜æ³•åˆ†é…å¾‹" },
        { s: 4, w: "Consecutive numbers", m: "é€£çºŒæ•¸" },
        { s: 5, w: "Degree", m: "åº¦" },
        { s: 5, w: "Round angle", m: "å‘¨è§’" },
        { s: 5, w: "Straight angle", m: "å¹³è§’" },
        { s: 5, w: "Protractor", m: "é‡è§’å™¨" },
        { s: 5, w: "Geometry", m: "å¹¾ä½•å­¸" },
        { s: 5, w: "Point (pt.)", m: "é»" },
        { s: 5, w: "Line", m: "ç·š" },
        { s: 5, w: "straight line (st. line)", m: "ç›´ç·š" },
        { s: 5, w: "curve", m: "æ›²ç·š" },
        { s: 5, w: "Line segment", m: "ç·šæ®µ" },
        { s: 5, w: "End point", m: "ç«¯é»" },
        { s: 5, w: "Point of intersection", m: "äº¤é»" },
        { s: 5, w: "Surface", m: "é¢" },
        { s: 5, w: "Plane", m: "å¹³é¢" },
        { s: 5, w: "Curved surface", m: "æ›²é¢" },
        { s: 5, w: "Angle (âˆ )", m: "è§’" },
        { s: 5, w: "Arm", m: "é‚Š" },
        { s: 5, w: "Vertex", m: "é ‚é»" },
        { s: 5, w: "Acute angle", m: "éŠ³è§’" },
        { s: 5, w: "Right angle", m: "ç›´è§’" },
        { s: 5, w: "Obtuse angle", m: "éˆè§’" },
        { s: 5, w: "Reflex angle", m: "åè§’" },
        { s: 5, w: "Complementary angles", m: "é¤˜è§’" },
        { s: 5, w: "Complementary", m: "äº’é¤˜" },
        { s: 5, w: "Supplementary angles (supp. âˆ s)", m: "è£œè§’" },
        { s: 5, w: "Supplementary", m: "äº’è£œ" },
        { s: 5, w: "Parallel lines (//)", m: "å¹³è¡Œç·š" },
        { s: 5, w: "Perpendicular lines", m: "å‚ç›´ç·š" },
        { s: 5, w: "Plane figure", m: "å¹³é¢åœ–å½¢" },
        { s: 5, w: "Circle", m: "åœ“" },
        { s: 5, w: "Centre of the circle", m: "åœ“å¿ƒ" },
        { s: 5, w: "Circumference", m: "åœ“å‘¨" },
        { s: 5, w: "Radius", m: "åŠå¾‘" },
        { s: 5, w: "Diameter", m: "ç›´å¾‘" },
        { s: 5, w: "Arc", m: "å¼§" },
        { s: 5, w: "Triangle", m: "ä¸‰è§’å½¢" },
        { s: 5, w: "Side", m: "é‚Š" },
        { s: 5, w: "Interior angles", m: "å…§è§’" },
        { s: 5, w: "Equilateral triangle", m: "ç­‰é‚Šä¸‰è§’å½¢" },
        { s: 5, w: "Isosceles triangle", m: "ç­‰è…°ä¸‰è§’å½¢" },
        { s: 5, w: "Acute-angled triangle", m: "éŠ³è§’ä¸‰è§’å½¢" },
        { s: 5, w: "Right-angled triangle", m: "ç›´è§’ä¸‰è§’å½¢" },
        { s: 5, w: "Obtuse-angled triangle", m: "éˆè§’ä¸‰è§’å½¢" },
        { s: 5, w: "Polygon", m: "å¤šé‚Šå½¢" },
        { s: 5, w: "Diagonal", m: "å°è§’ç¶«" },
        { s: 5, w: "Quadrilateral", m: "å››é‚Šå½¢" },
        { s: 5, w: "Pentagon", m: "äº”é‚Šå½¢" },
        { s: 5, w: "Hexagon", m: "å…­é‚Šå½¢" },
        { s: 5, w: "Heptagon", m: "ä¸ƒé‚Šå½¢" },
        { s: 5, w: "Octagon", m: "å…«é‚Šå½¢" },
        { s: 5, w: "Convex polygon", m: "å‡¸å¤šé‚Šå½¢" },
        { s: 5, w: "Concave polygon", m: "å‡¹å¤šé‚Šå½¢" },
        { s: 5, w: "Equilateral polygon", m: "ç­‰é‚Šå¤šé‚Šå½¢" },
        { s: 5, w: "Equiangular polygon", m: "ç­‰è§’å¤šé‚Šå½¢" },
        { s: 5, w: "Regular polygon", m: "æ­£å¤šé‚Šå½¢" },
        { s: 5, w: "Compasses", m: "åœ“è¦" },
        { s: 5, w: "Set square", m: "ä¸‰è§’å°º" },
        { s: 5, w: "Hypotenuse", m: "æ–œé‚Š" },
        { s: 5, w: "Three-dimensional figure", m: "ç«‹é«”åœ–å½¢" },
        { s: 5, w: "Solid", m: "ç«‹é«”" },
        { s: 5, w: "Face", m: "é¢" },
        { s: 5, w: "Edge", m: "é‚Š" },
        { s: 5, w: "Polyhedron", m: "å¤šé¢é«”" },
        { s: 5, w: "Cuboid", m: "é•·æ–¹é«”" },
        { s: 5, w: "Triangular prism", m: "ä¸‰è§’æŸ±" },
        { s: 5, w: "Quadrilateral pyramid", m: "å››è§’éŒ" },
        { s: 5, w: "Non-polyhedron", m: "éå¤šé¢é«”" },
        { s: 5, w: "Circular cylinder", m: "åœ“æŸ±" },
        { s: 5, w: "Circular cone", m: "åœ“éŒ" },
        { s: 5, w: "Sphere", m: "çƒé«”" },
        { s: 5, w: "Prism", m: "è§’æŸ±" },
        { s: 5, w: "Base", m: "åº•" },
        { s: 5, w: "Lateral face", m: "å´é¢" },
        { s: 5, w: "Slant edge", m: "å´ç¨œ" },
        { s: 5, w: "Right prism", m: "ç›´ç«‹è§’æŸ±" },
        { s: 5, w: "Pyramid", m: "è§’éŒ" },
        { s: 5, w: "Tetrahedron", m: "å››é¢é«”" },
        { s: 5, w: "Right pyramid", m: "ç›´ç«‹è§’éŒ" },
        { s: 5, w: "Right circular cylinder", m: "ç›´ç«‹åœ“æŸ±" },
        { s: 5, w: "Right circular cone", m: "ç›´ç«‹åœ“éŒ" },
        { s: 5, w: "Cross-section / section", m: "æ©«åˆ‡é¢ / æˆªé¢" },
        { s: 5, w: "Uniform cross-section", m: "å‡å‹»æ©«åˆ‡é¢" },
        { s: 5, w: "Isometric grid", m: "ç­‰è·æ–¹æ ¼" },
        { s: 5, w: "Oblique grid", m: "æ–œç¶²æ ¼" }
    ];

    let currentQuestions = [];
    let currentIndex = 0;
    let score = 0;
    let isAnswering = false;
    let wrongAnswers = []; // å„²å­˜éŒ¯é¡Œè³‡æ–™

    // æ´—ç‰Œå‡½æ•¸
    function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    function startGame() {
        try {
            // æ¸…ç©ºéŒ¯é¡Œè¨˜éŒ„
            wrongAnswers = [];

            // 1. ç²å–é¸å®šçš„ Sections
            const checkboxes = document.querySelectorAll('input[name="section"]:checked');
            let selectedSections = [];
            checkboxes.forEach((cb) => {
                selectedSections.push(parseInt(cb.value));
            });

            if (selectedSections.length === 0) {
                alert("è«‹è‡³å°‘é¸æ“‡ä¸€å€‹ç« ç¯€ (Chapter)ï¼");
                return;
            }

            // 2. éæ¿¾å­—åº«
            let pool = vocabData.filter(item => selectedSections.includes(item.s));

            // 3. ç²å–é¡Œç›®æ•¸é‡
            const qCountInput = document.querySelector('input[name="qCount"]:checked');
            let maxQ = parseInt(qCountInput.value);

            if (pool.length === 0) {
                alert("æ‰€é¸ç« ç¯€æ²’æœ‰è³‡æ–™ï¼");
                return;
            }

            // è‹¥å­—åº«å°‘æ–¼é¸æ“‡çš„é¡Œæ•¸ï¼Œå‰‡å…¨å‡º
            if (pool.length < maxQ) {
                maxQ = pool.length;
            }

            // 4. éš¨æ©Ÿé¸é¡Œ
            shuffle(pool);
            currentQuestions = pool.slice(0, maxQ);
            currentIndex = 0;
            score = 0;

            // 5. åˆ‡æ›ç•«é¢
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('quiz-screen').classList.remove('hidden');
            document.getElementById('result-screen').classList.add('hidden'); // ç¢ºä¿çµæœé éš±è—
            document.getElementById('mistake-area').innerHTML = ''; // æ¸…ç©ºèˆŠçš„éŒ¯é¡Œé¡¯ç¤º
            
            showQuestion();
        } catch (e) {
            console.error("Game Error:", e);
            alert("éŠæˆ²ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹æª¢æŸ¥ç¨‹å¼ç¢¼æ˜¯å¦å®Œæ•´è¤‡è£½ã€‚");
        }
    }

    function showQuestion() {
        isAnswering = true;
        const qData = currentQuestions[currentIndex];
        
        // æ›´æ–°é€²åº¦
        document.getElementById('progress').innerText = `é¡Œç›®: ${currentIndex + 1} / ${currentQuestions.length}`;
        document.getElementById('question-text').innerText = qData.w;

        // æº–å‚™é¸é … (1å€‹æ­£ç¢º + 3å€‹éŒ¯èª¤)
        let options = [{ text: qData.m, correct: true }];
        
        // éš¨æ©ŸæŠ½å–3å€‹éŒ¯èª¤é¸é … (å¾å®Œæ•´å­—åº«ä¸­æ’é™¤ç•¶å‰æ­£ç¢ºç­”æ¡ˆ)
        let distractors = vocabData.filter(v => v.m !== qData.m);
        shuffle(distractors);
        for(let i=0; i<3; i++) {
            if(distractors[i]) {
                options.push({ text: distractors[i].m, correct: false });
            }
        }
        
        shuffle(options);

        // æ¸²æŸ“æŒ‰éˆ•
        const container = document.getElementById('options-container');
        container.innerHTML = ''; // æ¸…ç©ºèˆŠæŒ‰éˆ•
        
        options.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            btn.innerText = opt.text;
            btn.onclick = () => checkAnswer(btn, opt.correct, qData); // å‚³å…¥ç•¶å‰å•é¡Œè³‡æ–™
            container.appendChild(btn);
        });
    }

    function checkAnswer(btn, isCorrect, qData) {
        if (!isAnswering) return; // é˜²æ­¢é‡è¤‡é»æ“Š
        isAnswering = false;

        const allBtns = document.querySelectorAll('.option-btn');
        
        if (isCorrect) {
            btn.classList.add('correct');
            score++;
        } else {
            btn.classList.add('wrong');
            
            // è¨˜éŒ„éŒ¯é¡Œ
            wrongAnswers.push({
                word: qData.w,
                wrong: btn.innerText,
                correct: qData.m
            });

            // é¡¯ç¤ºæ­£ç¢ºç­”æ¡ˆ
            allBtns.forEach(b => {
                if (b.innerText === qData.m) {
                    b.classList.add('correct');
                }
            });
        }

        // å»¶é²å¾Œé€²å…¥ä¸‹ä¸€é¡Œ
        setTimeout(() => {
            currentIndex++;
            if (currentIndex < currentQuestions.length) {
                showQuestion();
            } else {
                endGame();
            }
        }, 1500); // 1.5ç§’å¾Œä¸‹ä¸€é¡Œ
    }

    function endGame() {
        document.getElementById('quiz-screen').classList.add('hidden');
        document.getElementById('result-screen').classList.remove('hidden');
        
        const percentage = Math.round((score / currentQuestions.length) * 100);
        document.getElementById('score-display').innerText = `å¾—åˆ†: ${score} / ${currentQuestions.length} (${percentage}%)`;
        
        let msg = "";
        if (percentage === 100) msg = "å¤ªæ£’äº†ï¼å…¨éƒ¨ç­”å°ï¼ğŸ‰";
        else if (percentage >= 80) msg = "åšå¾—å¾ˆå¥½ï¼ç¹¼çºŒä¿æŒï¼ğŸ‘";
        else if (percentage >= 60) msg = "åŠæ ¼äº†ï¼Œå†æ¥å†å²ï¼ğŸ’ª";
        else msg = "åˆ¥ç°å¿ƒï¼Œå¤šç·´ç¿’å¹¾æ¬¡å°±æœƒäº†ï¼ğŸ“š";
        
        document.getElementById('final-message').innerText = msg;

        // ç”ŸæˆéŒ¯é¡Œåˆ—è¡¨
        const mistakeArea = document.getElementById('mistake-area');
        if (wrongAnswers.length > 0) {
            let html = '<div class="mistake-container">';
            html += '<div class="mistake-title">éŒ¯é¡Œé‡æº« (Review Mistakes)</div>';
            
            wrongAnswers.forEach(item => {
                html += `
                    <div class="mistake-item">
                        <div class="m-word">${item.word}</div>
                        <div class="m-wrong">âŒ ${item.wrong}</div>
                        <div class="m-correct">âœ… ${item.correct}</div>
                    </div>
                `;
            });

            html += '</div>';
            mistakeArea.innerHTML = html;
        } else {
            mistakeArea.innerHTML = ''; // å…¨å°å°±ä¸ç”¨é¡¯ç¤º
        }
    }
</script>

</body>
</html>

